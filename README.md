# Rusty_PresentParsing
Copyright Â© 2019 Chris Gatehouse

Project: Rusty_PresentParsing and Data Analysis

This project is an implementation of a parser for the PresentMon application. It will provide detailed results from the data collected with the PresentMon application

There are some existing parsers for the data that is generated with the PresentMon program but they are either not kept up anymore or don't analyze and present the data in ways that are completley useful to me. This is also meant to be an exercise in learning Rust in depth.

Planned functions: (CLI)
  1. Parse the CSV file generated by PresentMon
  2. Calculate the following  
    - [x] Avg. FPS  
    - [x] Avg. Frametimes  
    - [x] Median FPS  
    - [ ] Median Frametime  
    - [x] 1%/99% Low FPS exact and average  
    - [ ] 3%/97% Low FPS exact and average  
    - [X] Number of Dropped Frames  
    - [x] Frames below threshold values i.e. 30, 60, 144, 240 FPS  
    - [X] Detect number of frametime spikes that would be visible stutter\lag (initially implemented as jitter)

This program will operate on the command line. It will take a file to work on as an argument and generate and display the results on the [X] command line and also [ ] output the results to a log file.  

Stretch functions: (No specific order)
  - Work on multiple datasets in a given directory to combine results i.e. n runs of a game gives one set of results after processing
     - Partially implemented - process all csv files in a given directory and prints results for each
     - Not implemented - aggregate all results into one set of values
  - Parse CSV file generated by other programs that may be used simultaneuosly while gathering data i.e. HWiNFO  
  - Setup and start PresentMon and other programs and sync their data collection  
  - Move from CLI to GUI  
  - Generate new CSV or datafile that is easily consumed by other programs to generate graphs/charts  
  
Information on and PresetMon can be found here: https://github.com/GameTechDev/PresentMon

# Running the parser
To run this parser is simple. It takes an argument as either a single csv file that was generated by PresentMon or a directory that contains multiple csv files generated by PresentMon. I've included one small csv file generated by PresentMon in the data dir of this repo and will use it for the below examples.
  
Single file run with cargo: cargo run ..\data\data_1000.csv  
Output:   
Single file "..\\data\\data_1000.csv" is input  
Jitter before sorting: 0.55 ms  
Total frame time in ms: 5416.615999999999  
Total frame time in s: 5.416615999999999  
Total frames rendered: 1000  
Total dropped frames: 0  
Median FPS:     189.36  
1% Low FPS:     118.76  
0.1% Low FPS:   96.75  
Avg. FPS:       184.62  
Avg. 1% FPS:    114.24  
Avg. 0.1% FPS:  96.75  
Below 60 FPS:   0.00%  
Below 144 FPS:  5.60%  
Below 165 FPS:  10.20%  
Below 240 FPS:  100.00%  
  
Directory run with cargo: cargo run ..\data\  
Processing directory files in "..\\data\\"  
    
CSV FILES FOUND: 2  
    
WORKING FILE: "..\\data\\data_1000.csv"  
Jitter before sorting: 0.55 ms  
Total frame time in ms: 5416.615999999999  
Total frame time in s: 5.416615999999999  
Total frames rendered: 1000  
Total dropped frames: 0  
Median FPS:     189.36  
1% Low FPS:     118.76  
0.1% Low FPS:   96.75  
Avg. FPS:       184.62  
Avg. 1% FPS:    114.24  
Avg. 0.1% FPS:  96.75  
Below 60 FPS:   0.00%  
Below 144 FPS:  5.60%  
Below 165 FPS:  10.20%  
Below 240 FPS:  100.00%  
  
  
WORKING FILE: "..\\data\\PresentMon_dataset.csv"  
Jitter before sorting: 1.10 ms  
Total frame time in ms: 89543.58300000013  
Total frame time in s: 89.54358300000013  
Total frames rendered: 10512  
Total dropped frames: 0  
Median FPS:     118.69  
1% Low FPS:     65.05  
0.1% Low FPS:   54.19  
Avg. FPS:       117.40  
Avg. 1% FPS:    59.56  
Avg. 0.1% FPS:  53.01  
Below 60 FPS:   0.48%  
Below 144 FPS:  66.96%  
Below 165 FPS:  81.54%  
Below 240 FPS:  100.00%  
  
# License

This program is licenced under the "MIT License". Please see the file 'LICENSE' in this distribution for license terms.

